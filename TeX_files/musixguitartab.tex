%--------------------- Helper Commands ---------------------
\newcommand{\SetNoteLine}[1]{%
	\IfStrEqCase{#1}{%
		{1}{\xdef\noteline{o}}%
		{2}{\xdef\noteline{m}}%
		{3}{\xdef\noteline{k}}%
		{4}{\xdef\noteline{i}}%
		{5}{\xdef\noteline{g}}%
		{6}{\xdef\noteline{e}}}%
	[\xdef\noteline{c}]%
}

\newcommand{\SetStemFactorValue}[1]{%
	\IfStrEqCase{#1}{%
		{1}{\xdef\stemfactorvalue{17}}%
		{2}{\xdef\stemfactorvalue{14.5}}%
		{3}{\xdef\stemfactorvalue{12}}%
		{4}{\xdef\stemfactorvalue{9.5}}%
		{5}{\xdef\stemfactorvalue{7}}%
		{6}{\xdef\stemfactorvalue{4.5}}}%
	[\xdef\stemfactorvalue{2}]%
}


\newcommand{\SetStemFactorValueForHalfNote}[1]{%
	\IfStrEqCase{#1}{%
		{1}{\xdef\stemfactorvalue{16.5}}%
		{2}{\xdef\stemfactorvalue{14}}%
		{3}{\xdef\stemfactorvalue{11.5}}%
		{4}{\xdef\stemfactorvalue{9}}%
		{5}{\xdef\stemfactorvalue{6.5}}%
		{6}{\xdef\stemfactorvalue{4}}}%
	[\xdef\stemfactorvalue{1.5}]%
}

%--------------------- Notes ---------------------
% #1: string
% #2: fret
\newcommand{\zGuitarTab}[2]{\zltab{#1}{#2}}

% whole note 
\newcommand{\whGuitarTab}[2]{\whGuitarTabHalfDownStem{#1}{#2}}
\newcommand{\whGuitarTabHalfDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValueForHalfNote{#1}%
	\tinynotesize\ltab{#1}{#2}%
}

% half note
\newcommand{\hGuitarTab}[2]{\hGuitarTabHalfDownStem{#1}{#2}}
\newcommand{\hGuitarTabHalfDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValueForHalfNote{#1}%
	\tinynotesize\zcharnote{-7}{\def\stemfactor{1}\lhu{i}}\def\stemfactor{\stemfactorvalue}\zhl{\noteline}\ltab{#1}{#2}%
}

% quarter note
\newcommand{\qGuitarTab}[2]{\qGuitarTabDownStem{#1}{#2}}
\newcommand{\qGuitarTabDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValue{#1}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zql{\noteline}\ltab{#1}{#2}%
}

% eigth note
\newcommand{\cGuitarTab}[2]{\cGuitarTabDownStem{#1}{#2}}
\newcommand{\cGuitarTabDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValue{#1}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zcl{\noteline}\ltab{#1}{#2}%
}

% sixteenth note
\newcommand{\ccGuitarTab}[2]{\ccGuitarTabDownStem{#1}{#2}}
\newcommand{\ccGuitarTabDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValue{#1}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zccl{\noteline}\ltab{#1}{#2}%
}

% 1/32 note
\newcommand{\cccGuitarTab}[2]{\cccGuitarTabDownStem{#1}{#2}}
\newcommand{\cccGuitarTabDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValue{#1}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zcccl{\noteline}\ltab{#1}{#2}%
}

% 1/64 note
\newcommand{\ccccGuitarTab}[2]{\ccccGuitarTabDownStem{#1}{#2}}
\newcommand{\ccccGuitarTabDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValue{#1}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zccccl{\noteline}\ltab{#1}{#2}%
}

% 1/128 note
\newcommand{\cccccGuitarTab}[2]{\cccccGuitarTabDownStem{#1}{#2}}
\newcommand{\cccccGuitarTabDownStem}[2]{%
	\SetNoteLine{#1}%
	\SetStemFactorValue{#1}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zcccccl{\noteline}\ltab{#1}{#2}%
}

%--------------------- Dotted Notes ---------------------
% not sure about this one... some issues I see:
% - when having a note on low E string makes this function redundant (this function's dot by the note)
% - when having a note on A string this might look stupid...
% but in the end it's better to have a single function for this stuff
\newcommand{\zGuitarTabAddDotToStem}{\zGuitarTab{6}{\hspace{.12em}\textbf{.}}}
\newcommand{\zGuitarTabAddDotToStemWithFlag}{\zGuitarTab{6}{\hspace{.48em}\textbf{.}}}

%--------------------- Notes with Beams ---------------------
% #1: beam index
% #2: string
% #3: fret
\newcommand{\bGuitarTab}[3]{\bGuitarTabDownStem{#1}{#2}{#3}}
\newcommand{\bGuitarTabDownStem}[3]{%
	\SetNoteLine{#2}%
	\SetStemFactorValue{#2}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zqb{#1}{\noteline}\ltab{#2}{#3}%
}

\newcommand{\zbGuitarTab}[3]{\zbGuitarTabDownStem{#1}{#2}{#3}}
\newcommand{\zbGuitarTabDownStem}[3]{%
	\SetNoteLine{#2}%
	\SetStemFactorValue{#2}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\zqb{#1}{\noteline}\zltab{#2}{#3}%
}

\newcommand{\tbGuitarTab}[3]{\tbGuitarTabDownStem{#1}{#2}{#3}}
\newcommand{\tbGuitarTabDownStem}[3]{%
	\SetNoteLine{#2}%
	\SetStemFactorValue{#2}%
	\tinynotesize\def\stemfactor{\stemfactorvalue}\ztqb{#1}{\noteline}\ltab{#2}{#3}%
}

%--------------------- Beams ---------------------
% #1: beam index

% initiate beam
\newcommand{\ibeamGuitarTab}[1]{\tinynotesize\ibl{#1}e0}
\newcommand{\ibbeamGuitarTab}[1]{\tinynotesize\ibbl{#1}f0}
\newcommand{\ibbbeamGuitarTab}[1]{\tinynotesize\ibbbl{#1}f0}
\newcommand{\ibbbbeamGuitarTab}[1]{\tinynotesize\ibbbbl{#1}f0}
\newcommand{\ibbbbbeamGuitarTab}[1]{\tinynotesize\ibbbbbl{#1}f0}

% terminate beam
\newcommand{\tbeamGuitarTab}[1]{\tinynotesize\tbl{#1}}
\newcommand{\tbbeamGuitarTab}[1]{\tinynotesize\tbbl{#1}}
\newcommand{\tbbbeamGuitarTab}[1]{\tinynotesize\tbbbl{#1}}
\newcommand{\tbbbbeamGuitarTab}[1]{\tinynotesize\tbbbbl{#1}}
\newcommand{\tbbbbbeamGuitarTab}[1]{\tinynotesize\tbbbbbl{#1}}

% change beam multiplicity
\newcommand{\nbeamGuitarTab}[1]{\tinynotesize\nbl{#1}}
\newcommand{\nbbeamGuitarTab}[1]{\tinynotesize\nbbl{#1}}
\newcommand{\nbbbeamGuitarTab}[1]{\tinynotesize\nbbbl{#1}}
\newcommand{\nbbbbeamGuitarTab}[1]{\tinynotesize\nbbbbl{#1}}
\newcommand{\nbbbbbeamGuitarTab}[1]{\tinynotesize\nbbbbbl{#1}}

%--------------------- Slurs ---------------------
% initiate slur
\newcommand{\isluruGuitar}[2]{%
	\SetNoteLine{#2}%
	\isluru{#1}{\noteline}}
\newcommand{\islurdGuitar}[2]{%
	\SetNoteLine{#2}%
	\islurd{#1}{\noteline}}

% terminate slur
\newcommand{\tslurGuitar}[2]{%
	\SetNoteLine{#2}%
	\tslur{#1}{\noteline}}

%--------------------- Music group header ---------------------
\newcommand{\headerGuitarTab}[2]{%
	\instrumentnumber{1}%
	\generalmeter{\meterfrac{#1}{#2}}%
	\generalsignature{-1}%
	\setlines16\setclefsymbol1\tabclef\setsize1\largevalue\setsign10%
	\nobarnumbers%
}

%--------------------- Text (e.g. chord names) ---------------------
\newcommand{\zchordGuitarTab}[1]{\zcharnote{12}{\textbf{#1}}}

\newcommand{\ztextGuitarTab}[1]{\zcharnote{12}{#1}}
\newcommand{\ltextGuitarTab}[1]{\lcharnote{12}{#1}}
\newcommand{\ctextGuitarTab}[1]{\ccharnote{12}{#1}}

\newcommand{\ztextAboveTextGuitarTab}[1]{\zcharnote{15}{#1}}
\newcommand{\ltextAboveTextGuitarTab}[1]{\lcharnote{15}{#1}}
\newcommand{\ctextAboveTextGuitarTab}[1]{\ccharnote{15}{#1}}

\newcommand{\ztextBelowGuitarTab}[1]{\zcharnote{-4}{#1}}
\newcommand{\ltextBelowGuitarTab}[1]{\lcharnote{-4}{#1}}
\newcommand{\ctextBelowGuitarTab}[1]{\ccharnote{-4}{#1}}

